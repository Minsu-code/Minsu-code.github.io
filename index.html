<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KIM MINSUì˜ í˜ì´ì§€</title>
    <style>
        /* ì „ì²´ í˜ì´ì§€ ìŠ¤íƒ€ì¼ */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background: #f5f5f5;
            min-height: 100vh;
        }

        /* ë©”ì¸ ì»¨í…Œì´ë„ˆ */
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 2px 20px rgba(0,0,0,0.08);
            overflow: hidden;
        }

        /* í”„ë¡œí•„ ì„¹ì…˜ */
        .profile-section {
            background: white;
            border-bottom: 1px solid #e0e0e0;
            padding: 40px;
            text-align: center;
        }

        .profile-image {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            border: 3px solid #333;
            margin: 0 auto 20px;
            background: #fafafa;
            overflow: hidden;
        }

        .profile-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .profile-section h1 {
            margin: 10px 0;
            font-size: 32px;
            color: #222;
            font-weight: 600;
        }

        .profile-section p {
            margin: 5px 0;
            color: #666;
            font-size: 16px;
        }

        /* ì·¨ë¯¸/ê´€ì‹¬ì‚¬ íƒœê·¸ */
        .tags {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-top: 20px;
            justify-content: center;
        }

        .tag {
            background: #f8f8f8;
            border: 1px solid #e0e0e0;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 14px;
            color: #444;
        }

        /* ì¼ê¸° ì„¹ì…˜ */
        .diary-section {
            padding: 40px;
        }

        .diary-section h2 {
            color: #333;
            border-bottom: 2px solid #333;
            padding-bottom: 10px;
            margin-bottom: 30px;
            font-weight: 600;
        }

        /* ì¼ê¸° ëª©ë¡ í•­ëª© */
        .diary-item {
            background: #fafafa;
            border-left: 4px solid #333;
            padding: 20px 25px;
            margin-bottom: 15px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .diary-item:hover {
            transform: translateX(5px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
            background: #f0f0f0;
        }

        .diary-item-left {
            flex: 1;
        }

        .diary-title {
            color: #222;
            font-weight: 600;
            margin-bottom: 8px;
            font-size: 16px;
        }

        .diary-date {
            color: #888;
            font-size: 13px;
        }

        .diary-arrow {
            color: #666;
            font-size: 20px;
        }

        /* ìƒˆ ì¼ê¸° ì‘ì„± ë²„íŠ¼ */
        .write-btn {
            background: #333;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 15px;
            margin-bottom: 25px;
            transition: background 0.2s;
            width: 100%;
        }

        .write-btn:hover {
            background: #555;
        }

        /* ì¹´í…Œê³ ë¦¬ í•„í„° (íˆ¬ì í™œë™ìš©) */
        .category-filter {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .category-btn {
            background: #f0f0f0;
            border: 2px solid #e0e0e0;
            padding: 8px 20px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 14px;
            color: #666;
            transition: all 0.2s;
        }

        .category-btn:hover {
            background: #e8e8e8;
        }

        .category-btn.active {
            background: #333;
            color: white;
            border-color: #333;
        }

        /* ì¹´í…Œê³ ë¦¬ ë±ƒì§€ */
        .category-badge {
            display: inline-block;
            background: #f0f0f0;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 12px;
            color: #666;
            margin-left: 10px;
        }

        .category-badge.stock {
            background: #e8f5e9;
            color: #2e7d32;
        }

        .category-badge.coin {
            background: #fff3e0;
            color: #e65100;
        }

        /* ì¼ê¸° ì‘ì„± í¼ */
        .write-form {
            background: #fafafa;
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 25px;
            display: none;
        }

        .write-form.active {
            display: block;
            animation: fadeIn 0.3s;
        }

        .write-form h3 {
            margin-top: 0;
            color: #333;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: #444;
            font-weight: 500;
            font-size: 14px;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 14px;
            font-family: inherit;
            box-sizing: border-box;
        }

        .form-group textarea {
            min-height: 150px;
            resize: vertical;
        }

        .form-buttons {
            display: flex;
            gap: 10px;
        }

        .form-buttons button {
            flex: 1;
            padding: 10px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            transition: background 0.2s;
        }

        .submit-btn {
            background: #333;
            color: white;
        }

        .submit-btn:hover {
            background: #555;
        }

        .cancel-btn {
            background: #e0e0e0;
            color: #666;
        }

        .cancel-btn:hover {
            background: #d0d0d0;
        }

        /* ì¼ê¸° ìƒì„¸ í˜ì´ì§€ */
        .diary-detail {
            display: none;
            padding: 40px;
            animation: fadeIn 0.3s;
        }

        .diary-detail.active {
            display: block;
        }

        .back-button {
            background: #333;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            margin-bottom: 30px;
            transition: background 0.2s;
        }

        .back-button:hover {
            background: #555;
        }

        .detail-date {
            color: #888;
            font-size: 14px;
            margin-bottom: 15px;
        }

        .detail-title {
            color: #222;
            font-size: 28px;
            font-weight: 600;
            margin-bottom: 25px;
        }

        .detail-content {
            color: #444;
            line-height: 1.8;
            font-size: 16px;
        }

        /* í‘¸í„° */
        .footer {
            background: #fafafa;
            padding: 20px;
            text-align: center;
            color: #888;
            font-size: 14px;
            border-top: 1px solid #e0e0e0;
        }

        .hidden {
            display: none;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- í”„ë¡œí•„ ì„¹ì…˜ -->
        <div id="profileSection" class="profile-section">
            <div class="profile-image">
                <img src="https://i.ibb.co/CpBg0hNY/profile.png" alt="Profile" id="profileImg">
            </div>
            <h1>KIM MINSU</h1>
            <p>Beginner Developer Starting to Code</p>
            <p>ğŸ“ Samjeon-dong, Seoul, South Korea</p>
            <p style="color: #888; font-size: 14px; margin-top: 8px;">ğŸ‚ 1997.01.04</p>
            
            <div class="tags">
                <span class="tag">ğŸ¤– AI Learning</span>
                <span class="tag">ğŸ’» Coding</span>
            </div>
        </div>

        <!-- ì¼ê¸° ì„¹ì…˜ -->
        <div id="diarySection" class="diary-section">
            <h2>ğŸ“ ì¼ê¸°</h2>

            <!-- ìƒˆ ì¼ê¸° ì‘ì„± ë²„íŠ¼ -->
            <button class="write-btn" onclick="showWriteForm('diary')">âœï¸ ìƒˆ ì¼ê¸° ì“°ê¸°</button>

            <!-- ì¼ê¸° ëª©ë¡ -->
            <div id="diaryListContainer"></div>
        </div>

        <!-- íˆ¬ì í™œë™ ì„¹ì…˜ -->
        <div id="investmentSection" class="diary-section">
            <h2>ğŸ’° íˆ¬ì í™œë™</h2>

            <!-- ì¹´í…Œê³ ë¦¬ í•„í„° -->
            <div class="category-filter">
                <button class="category-btn active" onclick="filterInvestment('all')">ì „ì²´</button>
                <button class="category-btn" onclick="filterInvestment('stock')">ì£¼ì‹</button>
                <button class="category-btn" onclick="filterInvestment('coin')">ì½”ì¸</button>
            </div>

            <!-- ìƒˆ íˆ¬ì í™œë™ ì‘ì„± ë²„íŠ¼ -->
            <button class="write-btn" onclick="showWriteForm('investment')">âœï¸ ìƒˆ íˆ¬ì í™œë™ ì“°ê¸°</button>

            <!-- íˆ¬ì í™œë™ ëª©ë¡ -->
            <div id="investmentListContainer"></div>
        </div>

        <!-- ì¼ê¸° ìƒì„¸ í˜ì´ì§€ -->
        <div id="diaryDetail" class="diary-detail">
            <button class="back-button" onclick="showList()">â† ëª©ë¡ìœ¼ë¡œ</button>
            <div class="detail-date" id="detailDate"></div>
            <div class="detail-title" id="detailTitle"></div>
            <div class="detail-content" id="detailContent"></div>
        </div>

        <!-- í‘¸í„° -->
        <div class="footer">
            âœ¨ KIM MINSU's First Webpage âœ¨
        </div>
    </div>

    <script>
        // ë¹„ë°€ë²ˆí˜¸
        const ADMIN_PASSWORD = 'Dpfsleh105~';

        // Diary data - ì €ì¥ì†Œì—ì„œ ë¶ˆëŸ¬ì˜¤ê¸°
        let diaries = [];
        let investments = [];
        let investmentFilter = 'all';

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ëª¨ë“  ê¸€ ë¶ˆëŸ¬ì˜¤ê¸°
        window.onload = async function() {
            await loadAllPosts();
            renderDiaryList();
            renderInvestmentList();
        };

        // ì €ì¥ì†Œì—ì„œ ëª¨ë“  ê¸€ ë¶ˆëŸ¬ì˜¤ê¸°
        async function loadAllPosts() {
            try {
                // ì¼ê¸° ë¶ˆëŸ¬ì˜¤ê¸°
                const diaryResult = await window.storage.list('diary:', true);
                if (diaryResult && diaryResult.keys) {
                    const loadPromises = diaryResult.keys.map(async (key) => {
                        const data = await window.storage.get(key, true);
                        return data ? JSON.parse(data.value) : null;
                    });
                    
                    const loadedDiaries = await Promise.all(loadPromises);
                    diaries = loadedDiaries.filter(d => d !== null);
                    diaries.sort((a, b) => new Date(b.date) - new Date(a.date));
                }

                // íˆ¬ì í™œë™ ë¶ˆëŸ¬ì˜¤ê¸°
                const investmentResult = await window.storage.list('investment:', true);
                if (investmentResult && investmentResult.keys) {
                    const loadPromises = investmentResult.keys.map(async (key) => {
                        const data = await window.storage.get(key, true);
                        return data ? JSON.parse(data.value) : null;
                    });
                    
                    const loadedInvestments = await Promise.all(loadPromises);
                    investments = loadedInvestments.filter(d => d !== null);
                    investments.sort((a, b) => new Date(b.date) - new Date(a.date));
                }
            } catch (error) {
                console.log('ê¸€ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜:', error);
                // ì²« ì¼ê¸° ì¶”ê°€
                diaries = [{
                    id: 'diary_1',
                    title: "First Day of Coding Challenge",
                    date: "2026-01-17",
                    content: `Today I started studying coding for the first time.

To be honest, I still don't understand how it works and coding languages are too difficult and I don't even know what I'm doing right now.

Today, since it's my first time, I'm going to start with something simple.

The coding system told me to try making a website, so I'm going to make one, and I plan to gradually grow this website and make it entirely my own.`
                }];
                // ì²« ì¼ê¸° ì €ì¥
                await window.storage.set('diary:diary_1', JSON.stringify(diaries[0]), true);
            }
        }

        // ì¼ê¸° ëª©ë¡ ë Œë”ë§
        function renderDiaryList() {
            const container = document.getElementById('diaryListContainer');
            container.innerHTML = '';

            if (diaries.length === 0) {
                container.innerHTML = '<p style="color: #999; text-align: center; padding: 40px 0;">ì•„ì§ ì‘ì„±ëœ ì¼ê¸°ê°€ ì—†ìŠµë‹ˆë‹¤.</p>';
                return;
            }

            diaries.forEach((diary, index) => {
                const dateFormatted = formatDate(diary.date);

                container.innerHTML += `
                    <div class="diary-item" onclick="showPost('diary', ${index})">
                        <div class="diary-item-left">
                            <div class="diary-title">${diary.title}</div>
                            <div class="diary-date">${dateFormatted}</div>
                        </div>
                        <div class="diary-arrow">â†’</div>
                    </div>
                `;
            });
        }

        // íˆ¬ì í™œë™ ëª©ë¡ ë Œë”ë§
        function renderInvestmentList() {
            const container = document.getElementById('investmentListContainer');
            container.innerHTML = '';

            const filteredInvestments = investmentFilter === 'all' 
                ? investments 
                : investments.filter(i => i.category === investmentFilter);

            if (filteredInvestments.length === 0) {
                container.innerHTML = '<p style="color: #999; text-align: center; padding: 40px 0;">ì•„ì§ ì‘ì„±ëœ íˆ¬ì í™œë™ì´ ì—†ìŠµë‹ˆë‹¤.</p>';
                return;
            }

            filteredInvestments.forEach((investment, index) => {
                const realIndex = investments.indexOf(investment);
                const dateFormatted = formatDate(investment.date);
                const categoryText = investment.category === 'stock' ? 'ì£¼ì‹' : 'ì½”ì¸';
                const categoryClass = investment.category;

                container.innerHTML += `
                    <div class="diary-item" onclick="showPost('investment', ${realIndex})">
                        <div class="diary-item-left">
                            <div class="diary-title">
                                ${investment.title}
                                <span class="category-badge ${categoryClass}">${categoryText}</span>
                            </div>
                            <div class="diary-date">${dateFormatted}</div>
                        </div>
                        <div class="diary-arrow">â†’</div>
                    </div>
                `;
            });
        }

        // ë‚ ì§œ í¬ë§·íŒ…
        function formatDate(dateStr) {
            const date = new Date(dateStr);
            const months = ['January', 'February', 'March', 'April', 'May', 'June', 
                          'July', 'August', 'September', 'October', 'November', 'December'];
            return `${months[date.getMonth()]} ${date.getDate()}, ${date.getFullYear()}`;
        }

        // íˆ¬ì í™œë™ í•„í„°
        function filterInvestment(category) {
            investmentFilter = category;
            
            // ë²„íŠ¼ í™œì„±í™” ìƒíƒœ ë³€ê²½
            document.querySelectorAll('.category-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');

            renderInvestmentList();
        }

        // ì‘ì„± í¼ í‘œì‹œ (ë¹„ë°€ë²ˆí˜¸ í™•ì¸)
        function showWriteForm(type) {
            const password = prompt('ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”:');
            
            if (password !== ADMIN_PASSWORD) {
                alert('ë¹„ë°€ë²ˆí˜¸ê°€ í‹€ë ¸ìŠµë‹ˆë‹¤! ğŸš«');
                return;
            }

            const titleText = type === 'diary' ? 'ì¼ê¸°' : 'íˆ¬ì í™œë™';
            
            let categorySelect = '';
            if (type === 'investment') {
                categorySelect = `
                    <div class="form-group">
                        <label>ì¹´í…Œê³ ë¦¬</label>
                        <select id="postCategory">
                            <option value="stock">ì£¼ì‹</option>
                            <option value="coin">ì½”ì¸</option>
                        </select>
                    </div>
                `;
            }
            
            const formHtml = `
                <div class="write-form active" id="writeForm">
                    <h3>âœï¸ ìƒˆ ${titleText} ì‘ì„±</h3>
                    <div class="form-group">
                        <label>ì œëª©</label>
                        <input type="text" id="postTitle" placeholder="ì œëª©ì„ ì…ë ¥í•˜ì„¸ìš”">
                    </div>
                    ${categorySelect}
                    <div class="form-group">
                        <label>ë‚´ìš©</label>
                        <textarea id="postContent" placeholder="ë‚´ìš©ì„ ì‘ì„±í•˜ì„¸ìš”..."></textarea>
                    </div>
                    <div class="form-buttons">
                        <button class="submit-btn" onclick="savePost('${type}')">ì €ì¥í•˜ê¸°</button>
                        <button class="cancel-btn" onclick="hideWriteForm()">ì·¨ì†Œ</button>
                    </div>
                </div>
            `;

            const containerId = type === 'diary' ? 'diaryListContainer' : 'investmentListContainer';
            const container = document.getElementById(containerId);
            container.insertAdjacentHTML('beforebegin', formHtml);
        }

        // ì‘ì„± í¼ ìˆ¨ê¸°ê¸°
        function hideWriteForm() {
            const form = document.getElementById('writeForm');
            if (form) form.remove();
        }

        // ê¸€ ì €ì¥
        async function savePost(type) {
            const title = document.getElementById('postTitle').value;
            const content = document.getElementById('postContent').value;
            
            let category = null;
            if (type === 'investment') {
                category = document.getElementById('postCategory').value;
            }

            if (!title.trim()) {
                alert('ì œëª©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”!');
                return;
            }

            if (!content.trim()) {
                alert('ë‚´ìš©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”!');
                return;
            }

            // ì˜¤ëŠ˜ ë‚ ì§œì™€ ê³ ìœ  ID
            const today = new Date();
            const dateStr = today.toISOString().split('T')[0];
            const postId = type + '_' + Date.now();

            // ìƒˆ ê¸€ ê°ì²´
            const newPost = {
                id: postId,
                title: title,
                date: dateStr,
                content: content
            };

            if (type === 'investment') {
                newPost.category = category;
            }

            try {
                // ì €ì¥ì†Œì— ì €ì¥
                await window.storage.set(type + ':' + postId, JSON.stringify(newPost), true);
                
                // ë°°ì—´ì— ì¶”ê°€
                if (type === 'diary') {
                    diaries.unshift(newPost);
                    renderDiaryList();
                } else {
                    investments.unshift(newPost);
                    renderInvestmentList();
                }

                hideWriteForm();
                
                alert('ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤! ğŸ‰');
            } catch (error) {
                alert('ì €ì¥ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + error.message);
            }
        }

        // ê¸€ ìƒì„¸ ë³´ê¸°
        function showPost(type, index) {
            const post = type === 'diary' ? diaries[index] : investments[index];
            document.getElementById('detailDate').textContent = formatDate(post.date);
            document.getElementById('detailTitle').textContent = post.title;
            document.getElementById('detailContent').textContent = post.content;
            
            document.getElementById('profileSection').classList.add('hidden');
            document.getElementById('diarySection').classList.add('hidden');
            document.getElementById('investmentSection').classList.add('hidden');
            document.getElementById('diaryDetail').classList.add('active');
        }

        // ëª©ë¡ìœ¼ë¡œ ëŒì•„ê°€ê¸°
        function showList() {
            document.getElementById('profileSection').classList.remove('hidden');
            document.getElementById('diarySection').classList.remove('hidden');
            document.getElementById('investmentSection').classList.remove('hidden');
            document.getElementById('diaryDetail').classList.remove('active');
        }
    </script>
</body>
</html>
